
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Controlling the DAC and ADC via SPI &#8212; GPA-FHDO 1.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adapting the resistor and capacitor values" href="adapting-resistor-capacitor.html" />
    <link rel="prev" title="Connections" href="connections.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="controlling-the-dac-and-adc-via-spi">
<h1>Controlling the DAC and ADC via SPI<a class="headerlink" href="#controlling-the-dac-and-adc-via-spi" title="Permalink to this headline">¶</a></h1>
<p>Arduino sample code in C++ is provided, which can do simple tasks like performing a calibration, doing a ramp
for linearity measurements or setting the output current to a specific value.
We have tested the code on an Arduino MEGA. The program is controlled via Terminal with 115200 baud.
The commands are as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>f</p></td>
<td><p>searches the DAC value that corresponds to 0A current on the active channel. Always run this
command before doing a calibration.</p></td>
</tr>
<tr class="row-odd"><td><p>g</p></td>
<td><p>perform calibration on gain factors on the active channel.</p></td>
</tr>
<tr class="row-even"><td><p>r</p></td>
<td><p>runs a ramp on the active channel. The ramp min (rampMinAmp) and max (rampMaxAmp) current need
to be set in the source code. If the ramp is going over high currents (i.e. &gt; 3A), a duty
cycle can be switched on, to prevent OP amp from overheating. The sleep time after each output
can be defined in the source code (rampCyclePause).</p></td>
</tr>
<tr class="row-odd"><td><p>i</p></td>
<td><p>sets output current for the active channel to 0A and goes into idle mode.</p></td>
</tr>
<tr class="row-even"><td><p>d</p></td>
<td><p>reads current amplitude for the active channel and outputs it to terminal.</p></td>
</tr>
<tr class="row-odd"><td><p>q</p></td>
<td><p>outputs configuration on terminal.</p></td>
</tr>
<tr class="row-even"><td><p>p</p></td>
<td><p>outputs current pulses for rise time measurements on the active channel. The high
(pulseHighAmp) and low (pulseHighAmp) values of the pulse can be defined in the source code.
The ON time is 1/100 of a 100 ms cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>c[x]</p></td>
<td><p>changes active channel to ‘x’. x can be a number between 1 and 4. Example “c4” sets the active
channel to 4.</p></td>
</tr>
<tr class="row-even"><td><p>s[x]</p></td>
<td><p>sets the output current of the active channel to ‘x’. x can be only a single digit signed
integer number. Example “s-2” sets the active channel current to -2A.</p></td>
</tr>
</tbody>
</table>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">GPA-FHDO</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="general-overview.html">General Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-overview.html">Function Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="connections.html">Connections</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Controlling the DAC and ADC via SPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting-resistor-capacitor.html">Adapting the resistor and capacitor values</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimal-power-supply.html">Choosing the Optimal Power Supply</a></li>
<li class="toctree-l1"><a class="reference internal" href="automatic-calibration.html">Automatic calibration using the Arduino code</a></li>
<li class="toctree-l1"><a class="reference internal" href="measured-performance.html">Measured Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="maximum-ratings.html">Maximum ratings</a></li>
<li class="toctree-l1"><a class="reference internal" href="bom.html">Parts list</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly-instructions.html">Assembly Instructions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="connections.html" title="previous chapter">Connections</a></li>
      <li>Next: <a href="adapting-resistor-capacitor.html" title="next chapter">Adapting the resistor and capacitor values</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Benjamin Menkuec, Nils Allek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pages/dac-adc-control.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>