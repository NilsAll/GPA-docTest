
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Measured Performance &#8212; GPA-FHDO 1.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Automatic calibration using the Arduino code" href="automatic-calibration.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="measured-performance">
<h1>Measured Performance<a class="headerlink" href="#measured-performance" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 34%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rise-Time</p></td>
<td><p>32 microseconds</p></td>
</tr>
<tr class="row-odd"><td><p>Linearity (+-2A)</p></td>
<td><p>INL 12 LSB which equals about 4.5 mA (= 0.075%)</p></td>
</tr>
<tr class="row-even"><td><p>Linearity (+-6A)</p></td>
<td><p>INL 30 LSB which equals about 11.5 mA (= 0.192%)</p></td>
</tr>
<tr class="row-odd"><td><p>Ripple</p></td>
<td><p>none</p></td>
</tr>
<tr class="row-even"><td><p>Temperature offset error</p></td>
<td><p>max. 1 %</p></td>
</tr>
</tbody>
</table>
<section id="measurement-conditions">
<h2>Measurement Conditions<a class="headerlink" href="#measurement-conditions" title="Permalink to this headline">¶</a></h2>
<p>Coils used were the top and bottom x-gradients of the tabletop MRI plus their corresponding shields.
The coils can be found here.
The total inductance of this coils were 10 uH, the resistance was 50 milliohms.
The supply voltage was 15 V, the power supply used was a Rohde and Schwarz HMP4040.
A current step from 0 to 2 A was applied via an appropriate SPI command to the DAC.
The Rise-Time and Ripple was measured across the shunt-resistor on the PCB.</p>
<img alt="../_images/rise_time.jpg" src="../_images/rise_time.jpg" />
<p>The test configuration used 1 nF capacitors (C43 and C44), which is very conservative for the 10 uH load
and results in a big stability marging. Faster rise times are with 0.1 nF capacitors easily possible. Since
30 us rise times are fast enough for most applications, 1 nF was chosen as standard configuration.</p>
</section>
<section id="temperature-stability-analysis">
<h2>Temperature Stability Analysis<a class="headerlink" href="#temperature-stability-analysis" title="Permalink to this headline">¶</a></h2>
<p>Temperature stability analysis was performed by setting the output current to 2 A and then recording the
measured current until the power OP amp goes into overtemperature shutdown. According to the OPA 549 datasheet,
the shutdown happens when a junction temperature of 160 °C is reached and end when a temperature of 140 °C is
reached. With only small heatsinks installed and starting from room temperature, it took about 7 seconds until
overtemp shutdown happened. The analysis and image generation was done using
<a class="reference external" href="https://github.com/menkueclab/GPA-FHDO/blob/master/analyze_temperature_stability.m">this</a> Matlab script.
The input file for this Matlab script is the log of the terminal output. All other lines than the ones from the
‘read’ command need to be deleted manually. The log file should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mh">0x90fb</span>  <span class="mf">1.9982696</span>
<span class="mh">0x90fa</span>  <span class="mf">1.9978774</span>
<span class="mh">0x90fd</span>  <span class="mf">1.9990504</span>
<span class="mh">0x90fb</span>  <span class="mf">1.9982696</span>
<span class="mh">0x90fb</span>  <span class="mf">1.9982696</span>
<span class="mh">0x90fd</span>  <span class="mf">1.9990504</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This graph shows the recorded current values including the shutdown phase</p>
<img alt="../_images/temperature_stability_test.jpg" src="../_images/temperature_stability_test.jpg" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This graph shows the recorded current values without the power down phase. We can observe, that the error over a
temperature range from 20 °C to 160 °C is about 1 %.</p>
<img alt="../_images/temperature_stability_test_without_overtemp.jpg" src="../_images/temperature_stability_test_without_overtemp.jpg" />
</section>
<section id="linearity-analysis">
<h2>Linearity Analysis<a class="headerlink" href="#linearity-analysis" title="Permalink to this headline">¶</a></h2>
<p>Linearity was evaluated by reading current values from the ADC via SPI while applying a ramp on the DAC (see ramp
function in the supplied Arduino sample code). The analysis and image generation was done using
<a class="reference external" href="https://github.com/menkueclab/GPA-FHDO/blob/master/analyze_linearity.m">this</a> Matlab script. The input file for
this Matlab script is the log of the terminal output. All other lines than the ones from the ‘read’ command need to
be deleted manually. The log file should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mh">0xa7ea</span>  <span class="mf">0.0000000</span> <span class="mh">0x90d6</span>  <span class="mf">1.9838154</span>
<span class="mh">0xa7eb</span>  <span class="mf">0.0000000</span> <span class="mh">0x90d8</span>  <span class="mf">1.9845963</span>
<span class="mh">0xa7ec</span>  <span class="mf">0.0000000</span> <span class="mh">0x90da</span>  <span class="mf">1.9853783</span>
<span class="mh">0xa7ed</span>  <span class="mf">0.0000000</span> <span class="mh">0x90da</span>  <span class="mf">1.9853783</span>
<span class="mh">0xa7ee</span>  <span class="mf">0.0000000</span> <span class="mh">0x90db</span>  <span class="mf">1.9857693</span>
<span class="mh">0xa7ef</span>  <span class="mf">0.0000000</span> <span class="mh">0x90da</span>  <span class="mf">1.9853783</span>
<span class="mh">0xa7f0</span>  <span class="mf">0.0000000</span> <span class="mh">0x90db</span>  <span class="mf">1.9857693</span>
<span class="mh">0xa7f1</span>  <span class="mf">0.0000000</span> <span class="mh">0x90db</span>  <span class="mf">1.9857693</span>
<span class="mh">0xa7f2</span>  <span class="mf">0.0000000</span> <span class="mh">0x90de</span>  <span class="mf">1.9869399</span>
</pre></div>
</div>
<p>INL was calculated from the current of DAC value plots by drawing a straight line from the minimum current to the maximum current point and then taking the difference between the straigt line and measured data.</p>
<img alt="../_images/INL_LSB_2A.jpg" src="../_images/INL_LSB_2A.jpg" />
<img alt="../_images/INL_LSB_6A.jpg" src="../_images/INL_LSB_6A.jpg" />
<img alt="../_images/line_2A.jpg" src="../_images/line_2A.jpg" />
<img alt="../_images/line_zoom_2A.jpg" src="../_images/line_zoom_2A.jpg" />
<img alt="../_images/line_6A.jpg" src="../_images/line_6A.jpg" />
<img alt="../_images/line_zoom_6A.jpg" src="../_images/line_zoom_6A.jpg" />
<p>Calibration was performed over 33 points using first order lagrangian polynomials (linear interpolation). Using second order lagrangian polynomials would probably further improve linearity.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">GPA-FHDO</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="general-overview.html">General Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-overview.html">Function Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="connections.html">Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="dac-adc-control.html">Controlling the DAC and ADC via SPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting-resistor-capacitor.html">Adapting the resistor and capacitor values</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimal-power-supply.html">Choosing the Optimal Power Supply</a></li>
<li class="toctree-l1"><a class="reference internal" href="automatic-calibration.html">Automatic calibration using the Arduino code</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Measured Performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#measurement-conditions">Measurement Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#temperature-stability-analysis">Temperature Stability Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linearity-analysis">Linearity Analysis</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="automatic-calibration.html" title="previous chapter">Automatic calibration using the Arduino code</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Benjamin Menkuec, Nils Allek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pages/measured-performance.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>